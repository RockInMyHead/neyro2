#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API URL'–æ–≤ –≤ —Å–æ–±—Ä–∞–Ω–Ω–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –¥–ª—è TimeWeb

echo "üîÑ –û–±–Ω–æ–≤–ª—è—é API URL'—ã –¥–ª—è TimeWeb..."

# –ü—É—Ç—å –∫ —Å–æ–±—Ä–∞–Ω–Ω–æ–º—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É
FRONTEND_DIR="public"
BACKUP_DIR="public_backup"

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
if [ ! -d "$BACKUP_DIR" ]; then
    echo "üì¶ –°–æ–∑–¥–∞—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é..."
    cp -r "$FRONTEND_DIR" "$BACKUP_DIR"
fi

# –û–±–Ω–æ–≤–ª—è–µ–º API URL'—ã –≤ JavaScript —Ñ–∞–π–ª–∞—Ö
echo "üîß –ó–∞–º–µ–Ω—è—é localhost:8000 –Ω–∞ 194.87.226.56..."

# –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ JS —Ñ–∞–π–ª—ã –∏ –∑–∞–º–µ–Ω—è–µ–º URL'—ã
find "$FRONTEND_DIR" -name "*.js" -type f -exec sed -i '' 's|localhost:8000|194.87.226.56|g' {} \;
find "$FRONTEND_DIR" -name "*.js" -type f -exec sed -i '' 's|127.0.0.1:8000|194.87.226.56|g' {} \;

# –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ CSS —Ñ–∞–π–ª—ã –∏ –∑–∞–º–µ–Ω—è–µ–º URL'—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
find "$FRONTEND_DIR" -name "*.css" -type f -exec sed -i '' 's|localhost:8000|194.87.226.56|g' {} \;
find "$FRONTEND_DIR" -name "*.css" -type f -exec sed -i '' 's|127.0.0.1:8000|194.87.226.56|g' {} \;

echo "‚úÖ API URL'—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã!"
echo "üåê –¢–µ–ø–µ—Ä—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: http://194.87.226.56"
echo "üìÅ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤: $BACKUP_DIR" 