# Исправление проблем на сервере TimeWeb

## Проблемы, которые были обнаружены:

1. **404 Not Found для 2.mp3** - музыкальные файлы не доступны
2. **502 Bad Gateway для generate_dalle** - API эндпоинты не работают
3. **405 Method Not Allowed** - проблемы с HTTP методами

## Причина проблем:

Неправильная конфигурация nginx на сервере TimeWeb. Конфигурация использует неправильные пути к статическим файлам и не корректно проксирует запросы к backend.

## Способ исправления:

### Вариант 1: Автоматическое исправление (рекомендуется)

1. Подключитесь к вашему серверу TimeWeb через SSH
2. Перейдите в папку с проектом:
   ```bash
   cd /var/www/timeweb-deploy
   ```

3. Скачайте и запустите скрипт исправления:
   ```bash
   wget https://raw.githubusercontent.com/your-repo/fix-timeweb-server.sh
   chmod +x fix-timeweb-server.sh
   sudo bash fix-timeweb-server.sh
   ```

### Вариант 2: Ручное исправление

1. Подключитесь к серверу через SSH
2. Перейдите в папку с проектом
3. Запустите диагностику:
   ```bash
   sudo bash diagnose-nginx.sh
   ```

4. Примените исправления:
   ```bash
   sudo bash fix-nginx-universal.sh
   ```

## Проверка исправлений:

После применения исправлений проверьте:

1. **Музыка**: http://194.87.226.56/music/2.mp3
2. **API**: http://194.87.226.56/generate_dalle
3. **Главная страница**: http://194.87.226.56

## Возможные дополнительные проблемы:

Если после исправлений проблемы остались:

1. **Backend не запускается**: проверьте логи в `backend.log`
2. **Неправильные пути**: убедитесь что файлы находятся в правильных папках
3. **Права доступа**: проверьте права на папки `music/`, `images/`, `public/`

## Логи для диагностики:

```bash
# Nginx ошибки
sudo tail -f /var/log/nginx/error.log

# Backend логи
tail -f backend.log

# Nginx доступ
sudo tail -f /var/log/nginx/access.log
```

## Контакт для поддержки:

Если проблемы не удалось решить, проверьте:
- Правильность путей в nginx конфигурации
- Статус backend сервера
- Логи ошибок на сервере